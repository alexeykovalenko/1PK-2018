```{r setup, include=FALSE}
knitr::opts_chunk$set(warning=FALSE, message=FALSE)
```


```{r}
library(tidyverse)
library(kableExtra)
library(data.table)
library(ggplot2)
library(cluster) #Библиотека для каластерного анализа
library(captioner) #Библиотка для нумерации таблиц и рисунков и вообще всего
library(treemap) #Библиотека для площадных диаграмм
library(RColorBrewer) #Пакет для цветовых схем для диаграмм
#library(readxl) экспериментировал с импотром из экселя
library(DT) #экспериментировал с datatable
#library(htmltools) экспериментировал с datatable
```

```{r}
# Функция вывода таблицы с помощью библиотеки DT, 
get_dt = function(top_data, col_names = c("Федеральный округ" = "FO_name", "Субъект федерации" = "Subj_Name", "Срез показателя" = "Col_num"), output_file_name) {
  datatable(top_data, colnames = col_names, extensions = 'Buttons',
            escape = FALSE,
            rownames = FALSE,
            filter = 'top',
            options = list(searching = TRUE,
                           pageLength = 10,
                           lengthMenu = c(8, 10, 85, 100),
                           dom = 'Bfrtip',
                           buttons = 
                               list('colvis', list(
                                   extend = 'collection',
                                   buttons = list(list(extend='csv',
                                                       filename = output_file_name),
                                                  list(extend='excel',
                                                       filename = output_file_name)),
                                   text = 'Download'
                               )),
                           scrollX = TRUE,
                           pageLength = nrow(top_data))) 
}

#Функция установки счетчика нумерации для таблиц
table_nums <- captioner(prefix = "Таблица", levels = 2)

#Функция установки счетчика нумерации для таблиц
pic_nums <- captioner(prefix = "Рисунок", levels = 2)


#Функция для импорта данных из csv файлов в переменные R (требует имя файла в кавычках и берет из каталока data рабочей директории проекта)
import_table = function(file_name){
    read_delim(paste0("data/", file_name), ";", 
                 escape_double = FALSE, locale = locale(decimal_mark = ",", 
                 grouping_mark = "", encoding = "WINDOWS-1251"), 
                 trim_ws = TRUE)
}
```

#  Информационная база организации {#computer-maintenance}

## Количество персональных компьютеров и информационного оборудования


В таблице исходных данных данного раздела значение заголовков столбцов (соотвествуют номерам строк в таблице 5.1 формы 1-ПК 2018):

1. Персональные компьютеры, штук, всего
2. Из 1 - ноутбуки и другие портативные персональные компьютеры (кроме планшетных)
3. Из 1 - планшетные компьютеры
4. Из 1 - находящиеся в составе локальных вычислительных сетей
5. Из 1 - имеющие доступ к Интернету
6. Из 1 - имеющие доступ к Интранет-порталу организации
7. Из 1 - поступившие в отчетном году
8. Электронные терминалы (инфоматы)
9. Из 8 - с доступом к ресурсам Интернета
10. Мультимедийные проекторы
11. Интерактивные доски
12. Принтеры
13. Сканеры
14. Многофункциональные устройства (МФУ, выполняющие операции печати, сканирования, копирования)

Срезы (соответствуют номерам столбцов  таблицы 5.1 Формы 1-ПК):

3. Всего, штук
4. Из 3 - используемых в учебных целях	
5. Из 3	- доступных для использования обучающимися  в свободное от основных занятий время



```{r data51_import, echo = FALSE}
#Чтение таблицы исходных данных подраздела запись данных в переменную
tab51 <- import_table("tab51.csv")

#Факторизация переменных "Федеральный округ", "Субъект федерации", "Срез"
tab51[c("FO_name", "Subj_Name", "Col_num")] <- lapply(tab51[c("FO_name", "Subj_Name", "Col_num")] , factor)

```



```{r tab51formation, echo = FALSE}
#Вывод таблицы 5.1 в отчет
get_dt(tab51, , 'tab51_data')
```

##  Наличие специальных программных средств (кроме программных средств общего назначения) {#special-software}

В таблице исходных данных данного раздела значение заголовков столбцов (соотвествуют номерам строк в таблице 5.2 формы 1-ПК 2018):

1. Обучающие компьютерные программы по отдельным предметам или темам, пакеты программ по специальностям
2. Программы компьютерного тестирования 
3. Виртуальные тренажеры
4. Электронные версии справочников, энциклопедий, словарей и т.п.
5. Электронные версии учебных пособий по отдельным предметам или темам
6. Специальные программные средства  для научных исследований
7. Электронная библиотека
8. Электронные справочно-правовые системы
9. Специальные программные средства для решения организационных, управленческих и экономических задач (без учета систем автоматизированного документооборота)
10. Системы электронного документооборота
11. Средства контент-фильтрации доступа к Интернету
12. Другие специальные  программные средства

Срезы (соответствуют номерам столбцов  таблицы 5.2 Формы 1-ПК):

3. Наличие в организации (1 - да, 0 - нет)*
4. В том числе доступно для использования обучающимися (1 - да, 0 - нет)*

* Поскольку при агрегировании по субъектами федерации данные форм отдельных организаций суммируются, числа в срезах 3 и 4 означает число организаций, который указали в соответствующем поле формы 5.2 единицу. 



```{r data52_import, echo = FALSE}
#Чтение таблицы исходных данных подраздела запись данных в переменную
tab52 <- import_table("tab52.csv")

#Факторизация переменных "Федеральный округ", "Субъект федерации", "Срез"
tab52[c("FO_name", "Subj_Name", "Col_num")] <- lapply(tab52[c("FO_name", "Subj_Name", "Col_num")] , factor)

```



```{r tab52formation, echo = FALSE}
#Вывод таблицы 5.2 в отчет
get_dt(tab52, , 'tab52_data')
```

##  Максимальная скорость доступа к Интернету {#access-speed}

В таблице исходных данных данного раздела значение заголовков столбцов (соотвествуют номерам строк в таблице 5.3 формы 1-ПК 2018):

1. Максимальная скорость доступа к Интернету 	
2. максимальная скорость фиксированного проводного доступа к Интернету (модемное подключение через коммутируемую телефонную линию,  ISDN связь,  цифровая абонентская  линия (технология  xDSL и т.д.), другая кабельная связь (включая выделенные линии, оптоволокно и др.)
3. максимальная скорость фиксированного беспроводного доступа к Интернету (спутниковая связь, фиксированная беспроводная связь (например, Wi-Fi, WiMAX)	
4. максимальная скорость мобильного доступа к Интернету (через любое устройство: портативный компьютер или мобильный сотовый телефон и т. д.)

Срезы (соответствуют номерам столбцов  таблицы 5.3 Формы 1-ПК):

3. Количество организаций, имеющих доступ к Интернету со скоростью ниже 256 Кбит/сек
4. Количество организаций, имеющих доступ к Интернету со скоростью 256 - 511 Кбит/сек
5. Количество организаций, имеющих доступ к Интернету со скоростью 512 - 999 Кбит/сек
6. Количество организаций, имеющих доступ к Интернету со скоростью 1.0 - 1.9 Мбит/сек
7. Количество организаций, имеющих доступ к Интернету со скоростью 2.0 - 30.0 Мбит/сек
8. Количество организаций, имеющих доступ к Интернету со скоростью 30.1 - 100.0 Мбит/сек
9. Количество организаций, имеющих доступ к Интернету со скоростью выше 100 Мбит/сек

 
```{r data53_import, echo = FALSE}
#Чтение таблицы исходных данных подраздела запись данных в переменную
tab53 <- import_table("tab55.csv")

#Факторизация переменных "Федеральный округ", "Субъект федерации", "Срез"
tab53[c("FO_name", "Subj_Name", "Col_num")] <- lapply(tab53[c("FO_name", "Subj_Name", "Col_num")] , factor)

```



```{r tab53formation, echo = FALSE}
#Вывод таблицы 5.3 в отчет
get_dt(tab53, , 'tab53_data')
```

##  Информационная открытость организации {#transparency}


В таблице исходных данных данного раздела значение заголовков столбцов (соотвествуют номерам строк в таблице 5.4 формы 1-ПК 2018):

1. Адрес электронной почты (наличие)
2. Веб-сайт в Интернете
3. Наличие на веб-сайте информации о реализуемых образовательных программах (по нормативно закрепленному перечню сведений о  деятельности организации)
4. Наличие на веб-сайте информации о персональном составе педагогических работников
5. Наличие на веб-сайте информации о об объеме образовательной деятельности, финансовое обеспечение которой осуществляется за счет бюджетных ассигнований федерального бюджета, бюджетов субъектов Российской Федерации, местных бюджетов, по договорам об образовании за счет средств физических и (или) юридических лиц

Срезы (соответствуют номерам столбцов  таблицы 5.4 Формы 1-ПК):

3. Да - 1, Нет - 0 (единственный срез)*

* Поскольку при агрегировании по субъектами федерации данные форм отдельных организаций суммируются, число в единственном срезе означает число организаций, которые указали в соответствующем поле формы 5.4 единицу. 



```{r data54_import, echo = FALSE}
#Чтение таблицы исходных данных подраздела запись данных в переменную
tab54 <- import_table("tab54.csv")

#Факторизация переменных "Федеральный округ", "Субъект федерации", "Срез"
tab54[c("FO_name", "Subj_Name", "Col_num")] <- lapply(tab54[c("FO_name", "Subj_Name", "Col_num")] , factor)

```



```{r tab54formation, echo = FALSE}
#Вывод таблицы 5.4 в отчет
get_dt(tab54, , 'tab54_data')
```

##  Реализация образовательных программ с применением электронного обучения, дистанционных образовательных технологий {#mooc}

В таблице исходных данных данного раздела значение заголовков столбцов (соотвествуют номерам строк в таблице 5.5 формы 1-ПК 2018):

1. Применение электронного обучения
2. Применение дистанционных образовательных технологий

Срезы (соответствуют номерам столбцов  таблицы 5.5 Формы 1-ПК):

3. Программы повышения квалификации, да –  1;  нет –  0*
4. Программы профессиональной переподготовки, да –  1;  нет –  0*

* Поскольку при агрегировании по субъектами федерации данные форм отдельных организаций суммируются, числа в срезах 3 и 4 означают число организаций, которые указали в соответствующих полях формы 5.5 единицу. 


```{r data55_import, echo = FALSE}
#Чтение таблицы исходных данных подраздела запись данных в переменную
tab55 <- import_table("tab55.csv")

#Факторизация переменных "Федеральный округ", "Субъект федерации", "Срез"
tab55[c("FO_name", "Subj_Name", "Col_num")] <- lapply(tab55[c("FO_name", "Subj_Name", "Col_num")] , factor)

```



```{r tab55formation, echo = FALSE}
#Вывод таблицы 5.5 в отчет
get_dt(tab55, , 'tab55_data')
```

##  Формирование и использование  библиотечного фонда (включая библиотеки общежитий) {#libraries}

В таблице исходных данных данного раздела значение заголовков столбцов (соотвествуют номерам строк в таблице 5.6 формы 1-ПК 2018):

1. Объем библиотечного фонда –  всего, единиц (сумма столбцов 08-11)
2. Из 1 - учебная
3. Из 2 -обязательная
4. Из 1 - учебно-методическая
5. Из 4 - обязательная
6. Из 1 - художественная
7. Из 1 - научная литература
8. Из 1 - печатные  издания
9. Из 1 - аудиовизуальные документы
10. Из 1 - документы на микроформах
11. Из 1 - электронные документы

Срезы (соответствуют номерам столбцов  таблицы 5.6 Формы 1-ПК):

3. Поступило экземпляров за отчетный год
4. Выбыло экземпляров за отчетный год
5. Состоит экземпляров на конец отчетного года
6. Выдано экземпляров за отчетный год
7. Из 6 - выдано обучающимся



```{r data56_import, echo = FALSE}
#Чтение таблицы исходных данных подраздела запись данных в переменную
tab56 <- import_table("tab56.csv")

#Факторизация переменных "Федеральный округ", "Субъект федерации", "Срез"
tab56[c("FO_name", "Subj_Name", "Col_num")] <- lapply(tab56[c("FO_name", "Subj_Name", "Col_num")] , factor)

```



```{r tab56formation, echo = FALSE}
#Вывод таблицы 5.6 в отчет
get_dt(tab56, , 'tab56_data')
```

##  Информационное обслуживание и другие характеристики библиотеки (включая библиотеки общежитий) {#libraries-using}

В таблице исходных данных данного раздела значение заголовков столбцов (соотвествуют номерам строк в таблице 5.6 формы 1-ПК 2018):

1. Число посадочных мест  для пользователей библиотеки, мест
2. Из 1 - оснащены  персональными компьютерами
3. Из 2 - с доступом к Интернету
4. Численность зарегистрированных  пользователей библиотеки, человек
5. Из 4 - обучающиеся  организации
6. Число посещений, человек
7. Информационное обслуживание: число абонентов, единиц
8. Информационное обслуживание: выдано справок, единиц
9. Наличие (укажите соответствующий код: да –  1;  нет –  0) электронного каталога в библиотеке*
10. Наличие (да –  1;  нет –  0) доступа через Интернет к электронному каталогу*
11. Наличие (да –  1;  нет –  0) доступа через Интернет к полнотекстовым электронным ресурсам библиотеки* 

 
Срезы (соответствуют номерам столбцов  таблицы 5.6 Формы 1-ПК):

3. Фактически (единственный срез указываются значения в размерности, соответствующих показателей)

* Поскольку при агрегировании по субъектами федерации данные форм отдельных организаций суммируются, числа в срезе 3 означают число организаций, которые указали в соответствующих полях (см показатели 9 - 11) формы 5.6 единицу.


```{r data57_import, echo = FALSE}
#Чтение таблицы исходных данных подраздела запись данных в переменную
tab57 <- import_table("tab57.csv")

#Факторизация переменных "Федеральный округ", "Субъект федерации", "Срез"
tab57[c("FO_name", "Subj_Name", "Col_num")] <- lapply(tab57[c("FO_name", "Subj_Name", "Col_num")] , factor)

```



```{r tab57formation, echo = FALSE}
#Вывод таблицы 5.7 в отчет
get_dt(tab57, , 'tab57_data')
```


