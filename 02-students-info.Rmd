```{r setup, include=FALSE}
knitr::opts_chunk$set(warning=FALSE, message=FALSE)
```


```{r}
library(tidyverse)
library(kableExtra)
library(data.table)
library(ggplot2)
library(cluster) #Библиотека для каластерного анализа
library(captioner) #Библиотка для нумерации таблиц и рисунков и вообще всего
library(treemap) #Библиотека для площадных диаграмм
library(RColorBrewer) #Пакет для цветовых схем для диаграмм
#library(readxl) экспериментировал с импотром из экселя
library(DT) #экспериментировал с datatable
#library(htmltools) экспериментировал с datatable
```

```{r}
# Функция вывода таблицы с помощью библиотеки DT, 
get_dt = function(top_data, col_names = c("Федеральный округ" = "FO_name", "Субъект федерации" = "Subj_Name", "Срез показателя" = "Col_num"), output_file_name) {
  datatable(top_data, colnames = col_names, extensions = 'Buttons',
            escape = FALSE,
            rownames = FALSE,
            filter = 'top',
            options = list(searching = TRUE,
                           pageLength = 10,
                           lengthMenu = c(8, 10, 85, 100),
                           dom = 'Bfrtip',
                           buttons = 
                               list('colvis', list(
                                   extend = 'collection',
                                   buttons = list(list(extend='csv',
                                                       filename = output_file_name),
                                                  list(extend='excel',
                                                       filename = output_file_name)),
                                   text = 'Download'
                               )),
                           scrollX = TRUE,
                           pageLength = nrow(top_data))) 
}

#Функция установки счетчика нумерации для таблиц
table_nums <- captioner(prefix = "Таблица", levels = 2)

#Функция установки счетчика нумерации для таблиц
pic_nums <- captioner(prefix = "Рисунок", levels = 2)


#Функция для импорта данных из csv файлов в переменные R (требует имя файла в кавычках и берет из каталока data рабочей директории проекта)
import_table = function(file_name){
    read_delim(paste0("data/", file_name), ";", 
                 escape_double = FALSE, locale = locale(decimal_mark = ",", 
                 grouping_mark = "", encoding = "WINDOWS-1251"), 
                 trim_ws = TRUE)
}
```



# Сведения о численности слушателей, обученных по  дополнительным профессиональным программам {#students}

## Распределение слушателей по программам {#students-distribution}

В таблице исходны данных данного раздела значение заголовков столбцов (соотвествуют номерам строк в таблице 2.1 формы 1-ПК 2018):

1. Численность слушателей – всего (сумма строк  02,04,23, 25 – 27,29,32,37),  человек
2. Из 1 работники предприятий и  организаций
3. из них 2 - руководители
4. Из 1 работники образовательных организаций 
5. Из 4 - руководители образовательных организаций (сумма срезов 06-13) в том числе:
6. Из 5 - руководители дошкольных образовательных организаций
7. Из 5 - руководители общеобразовательных организаций
8. ИЗ 5 - руководители профессиональных образовательных организаций
9. Из 5 - руководители многофункциональных центров прикладных квалификаций
10. Из 5 - руководители образовательных организаций высшего образования
11. Из 5 - руководители организаций дополнительного  профессионального образования
12. Из 5 - руководители организаций дополнительного образования, реализующих дополнительные общеобразовательные программы для детей
13. Из 5 - руководители организаций дополнительного образования, реализующих дополнительные общеразвивающие  программы для взрослых
14. Из 4 - педагогические работники (сумма  срезов 15–22) в том числе:
15. Из 15 работники дошкольных образовательных организаций
16. Из 15 работники общеобразовательных организаций
17. Из 15 работники профессиональных образовательных организаций
18. Из 15 работники многофункциональных центров прикладных квалификаций
19. Из 15 работники образовательных организаций высшего образования
20. Из 15 работники организаций дополнительного профессионального образования
21. Из 15 работники организаций дополнительного образования, реализующих дополнительные общеобразовательные программы для детей
22. Из 15 работники организаций дополнительного образования, реализующих дополнительные общеразвивающие  программы для взрослых
23. Из 1 лица, замещающие государственные должности и должности государственной гражданской службы, в том числе:
24. Из 23 - руководители
25. Из 1 - Лица, замещающие муниципальные должности и должности муниципальной  службы
26. Из 1 - Лица, уволенные с военной службы
27. Из 1 - Лица по направлению службы занятости, из них:
28. Из 27 - безработные
29. Из 1 - Студенты, обучающиеся по образовательным программам среднего профессионального образования (сумма строк 30,31):
30. Из 29 - по программам подготовки квалифицированных рабочих, служащих
31. Из 29 - по программам подготовки специалистов среднего звена
32. Из 1 - Студенты, обучающиеся по программам высшего образования (сумма строк 33-36) в том числе по программам:
33. Из 32 - по программам бакалавриата
34. Из 32 - по программам специалитета
35. Из 32 - по программам магистратуры
36. Из 32 - по программам подготовки кадров высшей квалификации
37 Из 1 - другие слушатели
38. Из численности слушателей (из суммы срезов  02, 04, 23, 25 – 27, 37) имеют образование:
39. Из 38 - имеют среднее профессиональное (сумма строк 39,40), в том числе:
40. Из 39 - по программам подготовки квалифицированных рабочих, служащих
41. Из 39 - по программам подготовки специалистов среднего звена
42. Из 38 - высшее (сумма строк 42-45) в том числе подтвержденное дипломом:
43. Из 42 - бакалавра
44. Из 42 - специалиста
45. Из 42 - магистра
46. Из 42 - об окончании аспирантуры (адьюнктуры), ординатуры, ссистентуры-стажировки
47. Из общей численности слушателей (из среза 1) - инвалиды
48. Из 1 - дети-инвалиды 

Срезы (соответствуют номерам столбцов  таблицы 2.1 Формы 1-ПК):

3. Всего слушателей, обученных по дополнительным профессиональным  программам (сумма срезов 4 и 7), всего, человек
4. Из 3 обучено по программам повышения квалификации повышения квалификации
5. Из 4 обучено по программам повышения квалификации от 16 до 72 часов
6. Из 4 обучено по программам повышения квалификации свыше 72 часов
7. Из 3 обучено по программам профессиональной переподготовки всего
8. Из 7 обучено по программам профессиональной переподготовки по программам от 250 до 500 часов
9. Из 7 обучено по программам профессиональной переподготовки по программам свыше 500 часов
10. Из 7 с присвоением новой квалификации
11. Из 3 обучено в форме стажировки (полностью или частично) 
12. Из 11 по программам повышения квалификации
13. Из 11 по программам профессиональной переподготовки
14. Из 3 женщины



```{r data21_import, echo = FALSE}
#Чтение таблицы исходных данных подраздела запись данных в переменную
tab21 <- import_table("tab21.csv")

#Факторизация переменных "Федеральный округ", "Субъект федерации", "Срез"
tab21[c("FO_name", "Subj_Name", "Col_num")] <- lapply(tab21[c("FO_name", "Subj_Name", "Col_num")] , factor)

```





```{r tab21formation, echo = FALSE}
#Вывод таблицы 2.1 в отчет
get_dt(tab21, , 'tab21_data')
```



## Распределение слушателей по программам  и источникам финансирования обучения {#funding-distribution}

В таблице исходны данных данного раздела значение заголовков столбцов (соотвествуют номерам строк в таблице 2.2 формы 1-ПК 2018):

1. Численность слушателей – всего (сумма строк  02,04,23, 25 – 27,29,32,37),  человек
2. Из 1 работники предприятий и  организаций
3. из них 2 - руководители
4. Из 1 работники образовательных организаций 
5. Из 4 - руководители образовательных организаций (сумма срезов 06-13) в том числе:
6. Из 5 - руководители дошкольных образовательных организаций
7. Из 5 - руководители общеобразовательных организаций
8. ИЗ 5 - руководители профессиональных образовательных организаций
9. Из 5 - руководители многофункциональных центров прикладных квалификаций
10. Из 5 - руководители образовательных организаций высшего образования
11. Из 5 - руководители организаций дополнительного  профессионального образования
12. Из 5 - руководители организаций дополнительного образования, реализующих дополнительные общеобразовательные программы для детей
13. Из 5 - руководители организаций дополнительного образования, реализующих дополнительные общеразвивающие  программы для взрослых
14. Из 4 - педагогические работники (сумма  срезов 15–22) в том числе:
15. Из 15 работники дошкольных образовательных организаций
16. Из 15 работники общеобразовательных организаций
17. Из 15 работники профессиональных образовательных организаций
18. Из 15 работники многофункциональных центров прикладных квалификаций
19. Из 15 работники образовательных организаций высшего образования
20. Из 15 работники организаций дополнительного профессионального образования
21. Из 15 работники организаций дополнительного образования, реализующих дополнительные общеобразовательные программы для детей
22. Из 15 работники организаций дополнительного образования, реализующих дополнительные общеразвивающие  программы для взрослых
23. Из 1 лица, замещающие государственные должности и должности государственной гражданской службы, в том числе:
24. Из 23 - руководители
25. Из 1 - Лица, замещающие муниципальные должности и должности муниципальной  службы
26. Из 1 - Лица, уволенные с военной службы
27. Из 1 - Лица по направлению службы занятости, из них:
28. Из 27 - безработные
29. Из 1 - Студенты, обучающиеся по образовательным программам среднего профессионального образования (сумма строк 30,31):
30. Из 29 - по программам подготовки квалифицированных рабочих, служащих
31. Из 29 - по программам подготовки специалистов среднего звена
32. Из 1 - Студенты, обучающиеся по программам высшего образования (сумма строк 33-36) в том числе по программам:
33. Из 32 - по программам бакалавриата
34. Из 32 - по программам специалитета
35. Из 32 - по программам магистратуры
36. Из 32 - по программам подготовки кадров высшей квалификации
37 Из 1 - другие слушатели

Срезы (соответствуют номерам столбцов  таблицы 2.1 Формы 1-ПК):

3. Обучалось по программам повышения квалификации, всего человек (сумма 4 – 7)
4. Из 3 обучались за счет бюджетных ассигнований федерального бюджета
5. Из 3 обучались за счет бюджетных ассигнований  бюджетов субъектов РФ
6. Из 3 обучались за счет бюджетных ассигнований местных бюджетов
7. Из 3 обучались по договорам об оказании платных образовательных услуг (сумма срезов 8 – 9)
8. Из 7 обучались по договорам за счет средств физических лиц
9. Из 7 обучались по договорам за счет средств юридически лиц
10. Обучалось по программам профессиональной переподготовки, всего человек (сумма 11 – 14)
11. Из 10 обучались за счет бюджетных ассигнований федерального бюджета
12. Из 10 обучались за счет бюджетных ассигнований  бюджетов субъектов РФ
13. Из 10 обучались за счет бюджетных ассигнований местных бюджетов
14. Из 10 обучались по договорам об оказании платных образовательных услуг (сумма срезов 15 – 16)
15. Из 14 обучались по договорам за счет средств физических лиц
16. Из 14 обучались по договорам за счет средств юридически лиц



```{r data22_import, echo = FALSE}
#Чтение таблицы исходных данных подраздела запись данных в переменную
tab22 <- import_table("tab22.csv")

#Факторизация переменных "Федеральный округ", "Субъект федерации", "Срез"
tab22[c("FO_name", "Subj_Name", "Col_num")] <- lapply(tab22[c("FO_name", "Subj_Name", "Col_num")] , factor)

```



```{r tab22formation, echo = FALSE}
#Вывод таблицы 2.2 в отчет
get_dt(tab22, , 'tab22_data')
```


## Распределение лиц, обученных по дополнительным профессиональным программам, по формам обучения {#form-distribution}

В таблице исходных данных данного раздела значение заголовков столбцов (соотвествуют номерам строк в таблице 2.3 формы 1-ПК 2018):

1. Всего слушателей, обученных по  дополнительным профессиональным программам (сумма  2 и 5)
2. Из 1 обучено  по программам  повышения квалификации  (сумма 3 и 4)
3. Из 2 по программам в объеме от 16 до 72 часов
4. Из 2 по программам в объеме 72 часа и выше
5. Из 1 обучено по программам профессиональной переподготовки (сумма 6 и 7)
6. Из 25 по программам в объеме от 250 до 500 часов
7. Из 2 по программам в объеме 500 часов и выше
8. Из 5 - с присвоением новой квалификации 

Срезы (соответствуют номерам столбцов  таблицы 2.3 Формы 1-ПК):

3. Всего слушателей, обученных по  дополнительным профессиональным программам (сумма 4,6,8)
4. Из 3 обучено по очной форме обучения, всего
5. Из 4 обучено за счет бюджетных ассигнований
6. Из 3 обучено по очно-заочной форме обучения, всего
7. Из 6 обучено за счет бюджетных ассигнований
8. Из 3 обучено по заочной форме обучения, всего
9. Из 8 обучено за счет бюджетных ассигнований


```{r data23_import, echo = FALSE}
#Чтение таблицы исходных данных подраздела запись данных в переменную
tab23 <- import_table("tab23.csv")

#Факторизация переменных "Федеральный округ", "Субъект федерации", "Срез"
tab23[c("FO_name", "Subj_Name", "Col_num")] <- lapply(tab23[c("FO_name", "Subj_Name", "Col_num")] , factor)

```



```{r tab23formation, echo = FALSE}
#Вывод таблицы 2.2 в отчет
get_dt(tab23, , 'tab23_data')
```


## Распределение лиц,обученных по дополнительным профессиональным программам,по укрупненным группам специальностей (направлений подготовки) и программам {#spec-distribution}

### Программы повышения квалификации {#spec-distribution-pk}

В таблице исходных данных данного раздела значение заголовков столбцов (соотвествуют номерам строк в таблице 2.4.1 формы 1-ПК 2018):

1. Обучено по программам повышения квалификации – всего (сумма строк 02,69)
2. Обучено по укрупненным группам специальностей (направлений подготовки), всего (сумма 3-46,58-68)
3. Из 2 - математика и механика
4. Из 2 - компьютерные и информационные науки
5. Из 2 - физика и астрономия 
6. Из 2 - химия
7. Из 2 - науки о земле
8. Из 2 - биологические науки
9. Из 2 - архитектура
10. Из 2 - техника и технологии строительства
11. Из 2 - информатика и вычислительная техника
12. Из 2 - информационная безопасность 
13. Из 2 - электроника, радиотехника и системы связи
14. Из 2 - фотоника, приборостроение, оптические и биотехнические системы и технологии
15. Из 2 - электро- и теплоэнергетика
16. Из 2 - ядерная энергетика и технологии
17. Из 2 - машиностроение
18. Из 2 - физико-технические науки и технологии
19. Из 2 - оружие и системы вооружения
20. Из 2 - химические технологии
21. Из 2 - промышленная экология и биотехнологии
22. Из 2 - техносферная безопасность и природообустройство
23. Из 2 - прикладная геология, горное дело, нефтегазовое дело и геодезия
24. Из 2 - технологии материалов
25. Из 2 - техника и технологии наземного транспорта
26. Из 2 - авиационная и ракетно-космическая техника
27. Из 2 - аэронавигация и эксплуатация авиационной и ракетно-космической техники
27. Из 2 - техника и технологии кораблестроения и водного транспорта
29. Из 2 - управление в технических системах
30. Из 2 - нанотехнологии и наноматериалы
31. Из 2 - технологии легкой промышленности
32. Из 2 - фундаментальная медицина
33. Из 2 - клиническая медицина
34. Из 2 - науки о здоровье и профилактическая медицина
35. Из 2 - фармация
36. Из 2 - сестринское дело
37. Из 2 - сельское, лесное и рыбное хозяйство
38. Из 2 - ветеринария и зоотехния
39. Из 2 - психологические науки
40. Из 2 - экономика и управление
41. Из 2 - социология и социальная работа
42. Из 2 - юриспруденция 
43. Из 2 - политические науки и регионоведение 
44. Из 2 - средства массовой информации и информационно- библиотечное дело 
45. Из 2 - сервис и туризм
46. Из 2 - образование и педагогические науки 
47. Из 46 - обучено по программам, связанным с реализацией образовательных программ дошкольного образования
48. Из 46 - обучено по программам, связанным с реализацией образовательных программ начального общего образования
49. Из 46 - обучено по программам, связанным с реализацией образовательных программ основного общего образования
50. Из 46 - обучено по программам, связанным с реализацией образовательных программ среднего общего образования
51. Из 46 - обучено по программам, связанным с реализацией образовательных программ среднего профессионального образования
52. Из 46 - обучено по программам, связанным с реализацией образовательных программ высшего образования
53. Из 46 - обучено по программам, связанным с реализацией образовательных программ профессионального обучения
54. Из 46 - обучено по программам, связанным с реализацией образовательных программ дополнительных общеразвивающих программ
55. Из 46 - обучено по программам, связанным с реализацией образовательных программ дополнительных предпрофессиональных программ
56. Из 46 - обучено по программам, связанным с реализацией образовательных программ программ повышения квалификации
57. Из 46 - обучено по программам, связанным с реализацией образовательных программ программ профессиональной переподготовки
58. Из 2 - языкознание и литературоведение 
59. Из 2 - история и археология
60. Из 2 - философия, этика и религиоведение
61. Из 2 - теология 
62. Из 2 - физическая культура и спорт
63. Из 2 - искусствознание
64. Из 2 - культуроведение и социокультурные проекты
65. Из 2 - сценические искусства и литературное творчество
66. Из 2 - музыкальное искусство
67. Из 2 - изобразительное и прикладные виды искусств
68. Из 2 - экранные искусства
69. Из 1 - другие

Срезы (соответствуют номерам столбцов  таблицы 2.4.1 Формы 1-ПК):

3. Число реализованных программ, единиц (наименований)
4. Число обученных, всего (сумма срезов 5, 7, 18, 20-22, 24, 27, 32)
5. Из 4 - работники предприятий и организаций, всего	
6. Из 5 - руководители
7. Из 4 - работники образовательных организаций, всего								
8. Из 7 - руководители
9. Из 7 - педагогические работники (сумма срезов 10–17)
10. Из 9 - дошкольных образовательных организаций
11. Из 9 - общеобразовательных организаций
12. Из 9 - профессиональных образовательных организаций
13. Из 9 - многофункциональных центров прикладных квалификаций
14. Из 9 - образовательных организаций высшего образования
15. Из 9 - организаций дополнительного профессионального образования
16. Из 9 - организаций дополнительного образования, реализующих дополнительные общеобразовательные программы для детей
17. Из 9 - организаций дополнительного образования, реализующих общеразвивающие программы для взрослых
18. Из 4 - лица, замещающие должности государственной гражданской службы, всего
19. Из 18 - руководители
20. Из 4 - лица, замещающие муниципальные должности и должности муниципальной службы
21. Из 4 - лица, уволенные с военной службы
22. Из 4 - незанятые лица по направлению службы занятости
23. Из 22 - безработные
24. Из 4 - студенты, обучающиеся по образовательным программам среднего профессионального образования (сумма срзов 25, 26)
25. Из 24 - по программам подготовки квалифицированных рабочих, служащих
26. Из 24 - по программам подготовки специалистов среднего звена
27. Из 4 - студенты, обучающиеся по образовательным программам высшего образования (сумма срезов 28-31)
28. Из 27 - по программам бакалавриата
29. Из 27 - по программам специалитета
30. Из 27 - по программам магистратуры
31. Из 27 - по программам подготовки кадров высшей квалификации
32. Из 4 - другие (слушатели, не относящиеся ни к одной из категорий 5, 7, 18, 20-22, 24, 27)
33. Из суммы срезов 5,7, 18, 20,21,22,32 (имеющих законченное профессиональное образование) имеют среднее профессиональное, (сумма срезов 34, 35) образование
34. Из 33 имеют среднее профессиональное образование по программам подготовки квалифицированных рабочих, служащих
35. Из 33 имеют среднее профессиональное образование по программам подготовки специалистов среднего звена
36. Из суммы срезов 5,7, 18, 20,21,22,32 (имеющих законченное профессиональное образование) имеют высшее профессиональное образование
37. Из 36 - подтвержденное дипломом бакалавра
38. Из 36 - подтвержденное дипломом специалиста
39. Из 36 - подтвержденное дипломом магистра
40. Из 36 - подтвержденное дипломом об окончании аспирантуры (адьюнктуры), ординатуры, ассистентуры-стажировки
41. Из 4 обучено по очной форме обучения
42. Из 4 обучено по очно-заочной форме обучения
43. Из 4 обучено по заочной форме обучения


```{r data241_import, echo = FALSE}
#Чтение таблицы исходных данных подраздела запись данных в переменную
tab241 <- import_table("tab241.csv")

#Факторизация переменных "Федеральный округ", "Субъект федерации", "Срез"
tab241[c("FO_name", "Subj_Name", "Col_num")] <- lapply(tab241[c("FO_name", "Subj_Name", "Col_num")] , factor)

```



```{r tab241formation, echo = FALSE}
#Вывод таблицы 2.2 в отчет
get_dt(tab241, , 'tab241_data')
```


### Профессиональная переподготовка {#spec-distribution-pp}


В таблице исходных данных данного раздела значение заголовков столбцов (соотвествуют номерам строк в таблице 2.4.2 формы 1-ПК 2018) и аналогично названию столбцов в предыдущей таблице (2.4.1). Срезы (соответствуют номерам столбцов  таблицы 2.4.2 Формы 1-ПК). При этом срезы 3 - 43 как в предыдущей таблице (4.2.1), дополнительный срез 44 - численность обученных по программам профессиональной переподготовки с присвоением новой квалификации.



```{r data242_import, echo = FALSE}
#Чтение таблицы исходных данных подраздела запись данных в переменную
tab242 <- import_table("tab242.csv")

#Факторизация переменных "Федеральный округ", "Субъект федерации", "Срез"
tab242[c("FO_name", "Subj_Name", "Col_num")] <- lapply(tab242[c("FO_name", "Subj_Name", "Col_num")] , factor)

```



```{r tab242formation, echo = FALSE}
#Вывод таблицы 2.2 в отчет
get_dt(tab242, , 'tab242_data')
```


## Распределение слушателей по возрасту, полу и программам {#demography-distribution}

В таблице исходных данных данного раздела значение заголовков столбцов (соотвествуют номерам строк в таблице 2.5 формы 1-ПК 2018):

1. Численность слушателей – всего (сумма столбцов 3 и 5)
2. Из 1 численность женщин  – всего (сумма столбцов 4 и 6)
3. Из 1 - обученных по программам повышения квалификации
4. Из 3 - женщины
5. Из 1 - обученных по программам профессиональной переподготовки
6. Из 5 - женщины

Срезы (соответствуют номерам столбцов  таблицы 2.5 Формы 1-ПК):

3. Обучено всего (сумма гр.4 -13)
4. Из 3 в возрасте (число полных лет  по состоянию на 1 января 2018 года) моложе 25 лет
5. Из 3 в возрасте 25–29 лет
6. Из 3 в возрасте 30–34 года
7. Из 3 в возрасте 35–39 лет
8. Из 3 в возрасте 40–44 года
9. Из 3 в возрасте 45–49 лет
10. Из 3 в возрасте 50–54 года
11. Из 3 в возрасте 55–59	лет
12. Из 3 в возрасте 60–64 года
13. Из 3 в возрасте 65 и более лет


```{r data25_import, echo = FALSE}
#Чтение таблицы исходных данных подраздела запись данных в переменную
tab25 <- import_table("tab25.csv")

#Факторизация переменных "Федеральный округ", "Субъект федерации", "Срез"
tab25[c("FO_name", "Subj_Name", "Col_num")] <- lapply(tab25[c("FO_name", "Subj_Name", "Col_num")] , factor)

```



```{r tab25formation, echo = FALSE}
#Вывод таблицы 2.2 в отчет
get_dt(tab25, , 'tab25_data')
```
