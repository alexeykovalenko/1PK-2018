```{r setup, include=FALSE}
knitr::opts_chunk$set(warning=FALSE, message=FALSE)
```


```{r}
library(tidyverse)
library(kableExtra)
library(data.table)
library(ggplot2)
library(cluster) #Библиотека для каластерного анализа
library(captioner) #Библиотка для нумерации таблиц и рисунков и вообще всего
library(treemap) #Библиотека для площадных диаграмм
library(RColorBrewer) #Пакет для цветовых схем для диаграмм
#library(readxl) экспериментировал с импотром из экселя
library(DT) #экспериментировал с datatable
#library(htmltools) экспериментировал с datatable
```

```{r}
# Функция вывода таблицы с помощью библиотеки DT, 
get_dt = function(top_data, col_names = c("Федеральный округ" = "FO_name", "Субъект федерации" = "Subj_Name", "Срез показателя" = "Col_num"), output_file_name) {
  datatable(top_data, colnames = col_names, extensions = 'Buttons',
            escape = FALSE,
            rownames = FALSE,
            filter = 'top',
            options = list(searching = TRUE,
                           pageLength = 10,
                           lengthMenu = c(8, 10, 85, 100),
                           dom = 'Bfrtip',
                           buttons = 
                               list('colvis', list(
                                   extend = 'collection',
                                   buttons = list(list(extend='csv',
                                                       filename = output_file_name),
                                                  list(extend='excel',
                                                       filename = output_file_name),
                                                  list(extend='pdf',
                                                       filename= output_file_name)),
                                   text = 'Download'
                               )),
                           scrollX = TRUE,
                           pageLength = nrow(top_data))) 
}

#Функция установки счетчика нумерации для таблиц
table_nums <- captioner(prefix = "Таблица", levels = 2)

#Функция установки счетчика нумерации для таблиц
pic_nums <- captioner(prefix = "Рисунок", levels = 2)


#Функция для импорта данных из csv файлов в переменные R (требует имя файла в кавычках и берет из каталока data рабочей директории проекта)
import_table = function(file_name){
    read_delim(paste0("data/", file_name), ";", 
                 escape_double = FALSE, locale = locale(decimal_mark = ",", 
                 grouping_mark = "", encoding = "WINDOWS-1251"), 
                 trim_ws = TRUE)
}
```

# Сведения о персонале организации {#personal-info}

## Распределение численности персонала по уровню образования и полу {#personal-info-demography}

(без внешних совместителей и работающих по договорам гражданско-правового характера)


В таблице исходны данных данного раздела значение заголовков столбцов (соотвествуют номерам строк в таблице 3.1 формы 1-ПК 2018):

1. Численность работников – всего человек (сумма  столбцов 2, 6, 15, 18, 21, 24-29)
2. Из 1 руководящий  персонал – всего
3. Из 2 ректор (директор)
4. Из 2 проректоры (заместители директора)
5. Из 2 руководитель филиала
6. Из 1 профессорско-преподавательский состав – всего (сумма столбцов 7-14)
7. Из 6 - деканы факультетов
8. Из 6 - заведующие кафедрами
9. Из 6 - директора институтов
10. Из 6 - профессора
11. Из 6 - доценты
12. Из 6 - старшие преподаватели
13. Из 6 - преподаватели
14. Из 6 - ассистенты 
15. Из 1 педагогические работники структурных подразделений реализующих образовательные программы профессионального обучения, всего человек
16. Из 15 - преподаватели
17.  Из 15 - мастера производственного обучения
18.  Из 1 педагогические работники структурных подразделений, реализующих дополнительные общеразвивающие программы для взрослых, всего человек
19. Из 18 - педагоги дополнительного образования
20. Из 18 - тренеры-преподаватели
21. Из 1 педагогические работники структурных подразделений,  реализующих дополнительные профессиональные программы, всего человек
22. Из 21 - преподаватели
23. Из 21 - мастера производственного обучения
24. Из 1 - научные работники
25. Из 1 - инженерно-технический персонал
26. Из 1 - административно-хозяйственный персонал
27. Из 1 - производственный персонал
28. Из 1 - учебно-вспомогательный персонал
29. Из 1 - иной персонал

Срезы (соответствуют номерам столбцов  таблицы 3.1 Формы 1-ПК):

3. Всего, человек
4. Из 3 имеют высшее образование
5. Из 4 имеют ученую степень доктора наук
6. Из 4 имеют ученую степень кандидат наук
7. Из 4 имеют ученую степень PhD
8. Из 4 имеют ученое звание профессора
9. Из 4 имеют ученое звание доцента
10. Из 3 имеют среднее профессиональное образование по программам подготовки специалистов среднего звена
11. Из 3 имеют среднее профессиональное образование по программам подготовки квалифицированных рабочих, служащих
12. Из 3 имеют высшую квалификационню категорию
13. Из 3 имеют первую квалификационню категорию
14. Из 3 - женщины
15. Численность работников в пересчете на полную занятость, единиц 



```{r data31_import, echo = FALSE}
#Чтение таблицы исходных данных подраздела запись данных в переменную
tab31 <- import_table("tab31.csv")

#Факторизация переменных "Федеральный округ", "Субъект федерации", "Срез"
tab31[c("FO_name", "Subj_Name", "Col_num")] <- lapply(tab31[c("FO_name", "Subj_Name", "Col_num")] , factor)

```



```{r tab31formation, echo = FALSE}
#Вывод таблицы 3.1 в отчет
get_dt(tab31, , 'tab31_data')
```

## Распределение персонала по стажу работы {#personal-work-experience}

(без внешних совместителей и работающих по договорам гражданско-правового характера)


В таблице исходны данных данного раздела значение заголовков столбцов (соотвествуют номерам строк в таблице 3.2 формы 1-ПК 2018) и аналогично названию столбцов в предыдущей таблице (3.1)

Срезы (соответствуют номерам столбцов  таблицы 3.2 Формы 1-ПК):

3. Всего, человек (сумма срезов 4-9)
4. Из 3 – имеют общий стаж работы до 3 лет
5. Из 3 – имеют общий стаж работы от 3 до 5 лет
6. Из 3 – имеют общий стаж работы от 5 до 10 лет
7. Из 3 – имеют общий стаж работы 10 - 15 лет
8. Из 3 – имеют общий стаж работы 15 - 20 лет
9. Из 3 – имеют общий стаж работы 20 и более лет
10 Из 3  имеют стаж педагогической работы - всего (сумма срезов 11-16)
11. Из 10 имеют педагогический стаж до 3 лет
12. Из 10 имеют педагогический стаж от 3 до 5 лет
13. Из 10 имеют педагогический стаж от 5 до 10 лет
14. Из 10 имеют педагогический стаж от 10 до 15 лет
15. Из 10 имеют педагогический стаж от 15 до 20 лет
16. Из 10 имеют педагогический стаж 20 и более лет
17. Из 3 не имеют педагогического стажа работы



```{r data32_import, echo = FALSE}
#Чтение таблицы исходных данных подраздела запись данных в переменную
tab32 <- import_table("tab32.csv")

#Факторизация переменных "Федеральный округ", "Субъект федерации", "Срез"
tab32[c("FO_name", "Subj_Name", "Col_num")] <- lapply(tab32[c("FO_name", "Subj_Name", "Col_num")] , factor)

```



```{r tab32formation, echo = FALSE}
#Вывод таблицы 3.2 в отчет
get_dt(tab32, , 'tab32_data')
```

## Численность внешних совместителей,  работающих по договорам гражданско - правового характера и на условиях внутреннего совместительства и совмещения профессий (должностей) {byworker-info}

### Численность внешних совместителей {byworker-external}


В таблице исходны данных данного раздела значение заголовков столбцов (соотвествуют номерам строк в таблице 3.3.1 формы 1-ПК 2018):

1. Численность работников – всего человек (сумма  столбцов 2, 3, 12, 15, 17, 21-29)
2. Из 1 руководящий  персонал – всего
3. Из 1 профессорско-преподавательский состав – всего (сумма столбцов 7-14)
4. Из 3 - деканы факультетов
5. Из 3 - заведующие кафедрами
6. Из 3 - директора институтов
7. Из 3 - профессора
8. Из 3 - доценты
9. Из 3 - старшие преподаватели
10. Из 3 - преподаватели
11. Из 3 - ассистенты 
12. Из 1 педагогические работники структурных подразделений реализующих образовательные программы профессионального обучения, всего человек
13. Из 12 - преподаватели
14.  Из 12 - мастера производственного обучения
15.  Из 1 педагогические работники структурных подразделений, реализующих дополнительные общеразвивающие программы для взрослых, всего человек
16. Из 15 - педагоги дополнительного образования
17. Из 15 - тренеры-преподаватели
18. Из 1 педагогические работники структурных подразделений,  реализующих дополнительные профессиональные программы, всего человек
19. Из 18 - преподаватели
20. Из 18 - мастера производственного обучения
21. Из 1 - научные работники
22. Из 1 - инженерно-технический персонал
23. Из 1 - административно-хозяйственный персонал
24. Из 1 - производственный персонал
25. Из 1 - учебно-вспомогательный персонал
26. Из 1 - иной персонал
27. Из 3 численность работников предприятий и организаций, привлеченных к образовательной деятельности - всего
28. Из 27 - из предприятий и организаций реального сектора экономики
29. Из суммы 19 и 20 - численность работников предприятий и организаций, привлеченных к  образовательной деятельности - всего 
30. Из 29 - из предприятий и организаций реального сектора экономики
31. Численность   профессорско-преподавательского состава, использующего в учебном процессе персональные компьютеры (чел)
32. Численность   педагогических работников структурных подразделений, реализующих дополнительные  профессиональные  программы,  использующие в учебном процессе персональные компьютеры (чел)


Срезы (соответствуют номерам столбцов  таблицы 3.3.1 Формы 1-ПК) и аналогичны срезам таблицы раздела 3.1 (таблица 3.1)

```{r data331_import, echo = FALSE}
#Чтение таблицы исходных данных подраздела запись данных в переменную
tab331 <- import_table("tab331.csv")

#Факторизация переменных "Федеральный округ", "Субъект федерации", "Срез"
tab331[c("FO_name", "Subj_Name", "Col_num")] <- lapply(tab331[c("FO_name", "Subj_Name", "Col_num")] , factor)

```



```{r tab331formation, echo = FALSE}
#Вывод таблицы 3.3.1 в отчет
get_dt(tab331, , 'tab331_data')
```


### Численность работников, выполняющих  работы по договорам гражданско - правового характера {byworker-contract}


В таблице исходных данных данного раздела значение заголовков столбцов (соотвествуют номерам строк в таблице 3.3.2 формы 1-ПК 2018):

1. Численность  работников, выполняющих  работы  по договорам гражданско-правового характера – всего
2. Из 1 - осуществляющие образовательную деятельность по реализации дополнительных профессиональных программ

Срезы (соответствуют номерам столбцов  таблицы 3.3.2 Формы 1-ПК):

3. Всего, человек
4. Из 3 - численность работников предприятий и организаций:
5. Из 4 - предприятий и организаций реального сектора экономики



```{r data332_import, echo = FALSE}
#Чтение таблицы исходных данных подраздела запись данных в переменную
tab332 <- import_table("tab332.csv")

#Факторизация переменных "Федеральный округ", "Субъект федерации", "Срез"
tab332[c("FO_name", "Subj_Name", "Col_num")] <- lapply(tab332[c("FO_name", "Subj_Name", "Col_num")] , factor)

```



```{r tab332formation, echo = FALSE}
#Вывод таблицы 3.3.1 в отчет
get_dt(tab332, , 'tab332_data')
```


### Численность работников, осуществляющих образовательную деятельность по реализации  дополнительных профессиональных  программ на условиях внутреннего совместительства и совмещения профессий (должностей) {byworker-internal}

В таблице исходных данных данного раздела значение заголовков столбцов (соотвествуют номерам строк в таблице 3.3.3 формы 1-ПК 2018):

1. Численность  работников, осуществляющих образовательную деятельность по реализации дополнительных профессиональных  программ на условиях внутреннего совместительства, чел.
2. Численность работников, осуществляющих образовательную  деятельность по реализации дополнительных профессиональных  программ на условиях совмещения профессий (должностей), чел.

Срезы (соответствуют номерам столбцов  таблицы 3.3.1 Формы 1-ПК):

3. Всего (единственный срез)


```{r data333_import, echo = FALSE}
#Чтение таблицы исходных данных подраздела запись данных в переменную
tab333 <- import_table("tab333.csv")

#Факторизация переменных "Федеральный округ", "Субъект федерации", "Срез"
tab333[c("FO_name", "Subj_Name", "Col_num")] <- lapply(tab333[c("FO_name", "Subj_Name", "Col_num")] , factor)

```



```{r tab333formation, echo = FALSE}
#Вывод таблицы 3.3.1 в отчет
get_dt(tab333, , 'tab333_data')
```

## Сведения о дополнительном профессиональном образовании персонала {personal-education}


В таблице исходных данных данного раздела значение заголовков столбцов (соотвествуют номерам строк в таблице 3.4 формы 1-ПК 2018):

1. Численность работников – всего человек (сумма  столбцов 2, 6, 15, 18, 21, 24-29)
2. Из 1 руководящий  персонал – всего
3. Из 2 ректор (директор)
4. Из 2 проректоры (заместители директора)
5. Из 1 профессорско-преподавательский состав – всего (сумма столбцов 7-14)
6. Из 5 - деканы факультетов
7. Из 5 - заведующие кафедрами
8. Из 5 - директора институтов
9. Из 5 - профессора
10. Из 5 - доценты
11. Из 5 - старшие преподаватели
12. Из 5 - преподаватели
13. Из 5 - ассистенты 
14. Из 1 педагогические работники структурных подразделений, реализующих дополнительные профессиональные программы, всего человек
15. Из 14 - преподаватели
16. Из 14 - мастера производственного обучения
17. Из 1 - научные работники
18. Из 1 - инженерно-технический персонал
19. Из 1 - учебно-вспомогательный персонал

Срезы (соответствуют номерам столбцов  таблицы 3.4 Формы 1-ПК):

3. Всего, человек
4. Из 3 - прошли за последние три года повышение квалификации и (или) профессиональную переподготовку 
5. Из 4 - по профилю педагогической деятельности
6. Из 4 - по использованию информационных и коммуникаци-нных технологий
7. Из 4 - в форме стажировки
8. Из срезов 4-7 (прошедших ПК и/или ПП за последние 3 года) прошли ПК и/или ПК в отчетном году, всего
9. Из 8 - по профилю педагогической деятельности
10. Из 8 - по использованию информационных и коммуникационных технологий
11. Из 8 - в форме стажировки
12. Из 11 - в ведущих российских и зарубежных университетах и научных центрах
13. Из 12 - в зарубежных университетах и научных центрах


```{r data34_import, echo = FALSE}
#Чтение таблицы исходных данных подраздела запись данных в переменную
tab34 <- import_table("tab34.csv")

#Факторизация переменных "Федеральный округ", "Субъект федерации", "Срез"
tab34[c("FO_name", "Subj_Name", "Col_num")] <- lapply(tab34[c("FO_name", "Subj_Name", "Col_num")] , factor)

```



```{r tab34formation, echo = FALSE}
#Вывод таблицы 3.4 в отчет
get_dt(tab34, , 'tab34_data')
```


## Сведения об иностранных работниках {#foreign-personal}

В таблице исходных данных данного раздела значение заголовков столбцов (соотвествуют номерам строк в таблице 3.5 формы 1-ПК 2018):

1. Профессорско-преподавательский состав, всего 
2. Научные работники, всего 
3. Инженерно-технический персонал, всего
4. Учебно-вспомогательный персонал, сего
5. Педагогические работники структурных подразделений, реализующих дополнительные профессиональные программы, всего   
6. Из 5 - преподаватели
7. Из 5 - мастера производственного обучения
8. Численность иностранных специалистов, осуществляющих  образовательную  деятельность по реализации  дополнительных профессиональных программ  по договорам гражданско-правового характера – всего
9. Из 8 - граждане государств-участников СНГ
10. Из 8 - граждане стран Европейского союза и США

Срезы (соответствуют номерам столбцов  таблицы 3.5 Формы 1-ПК):

3. Численность иностранных работников без внешних совместителей и работающих по договорам гражданско-правового характера
4. Из 3 - граждане государств-участников СНГ
5. Из 3 - стран Европейского Союза и США
6. Численность иностранных работников,  работающих на условиях внешнего  совместительства, человек
7. Из 6 - граждане государств-участников СНГ
8. Из 6 - стран Европейского Союза и США
9. Численность иностранных работников (без внешних совместителей и работающих по договорам гражданско-правового характера) в пересчете на полную занятость, единиц	
10. Численность иностранных работников (внешние совместители) в пересчете на полную занятость, единиц	



```{r data35_import, echo = FALSE}
#Чтение таблицы исходных данных подраздела запись данных в переменную
tab35 <- import_table("tab35.csv")

#Факторизация переменных "Федеральный округ", "Субъект федерации", "Срез"
tab35[c("FO_name", "Subj_Name", "Col_num")] <- lapply(tab35[c("FO_name", "Subj_Name", "Col_num")] , factor)

```



```{r tab35formation, echo = FALSE}
#Вывод таблицы 3.5 в отчет
get_dt(tab35, , 'tab35_data')
```

## Движение работников {#movement-personal}

В таблице исходны данных данного раздела значение заголовков столбцов (соотвествуют номерам строк в таблице 3.6 формы 1-ПК 2018) и аналогично названию столбцов в таблице раздела 3.1 (Таблица 3.1)

Срезы (соответствуют номерам столбцов  таблицы 3.6 Формы 1-ПК):

3. Число ставок по штату, единиц 
4. Фактически занято всего, единиц
5. Из 4 - работниками списочного состава
6. Численность  работников на  начало  отчетного  года (без внешних совместителей и работавших по договорам гражданско-правового характера), человек
7. Принято работников за отчетный год всего, человек
8. Из 7 - выпускники со средним профессиональным образованием по программам подготовки специалистов среднего звена
9. Из 7 - выпускники с высшим профессиональным образованием
10. Выбыло работников за отчетный год всего, человек	
11. Из 10 - по собственному желанию
12. Численность работников на конец отчетного года (без совместителей и работающих по договорам гражданско-правового характера), человек


```{r data36_import, echo = FALSE}
#Чтение таблицы исходных данных подраздела запись данных в переменную
tab36 <- import_table("tab36.csv")

#Факторизация переменных "Федеральный округ", "Субъект федерации", "Срез"
tab36[c("FO_name", "Subj_Name", "Col_num")] <- lapply(tab36[c("FO_name", "Subj_Name", "Col_num")] , factor)

```



```{r tab36formation, echo = FALSE}
#Вывод таблицы 3.6 в отчет
get_dt(tab36, , 'tab36_data')
```

## Распределение персонала по  возрасту и полу {#personal-demography}

### Распределение персонала без внешних совместителей и работающих по договорам гражданско-правового характера по возрасту и полу {#personal1-demography}


В таблице исходны данных данного раздела значение заголовков столбцов (соотвествуют номерам строк в таблице 3.7.1 формы 1-ПК 2018) и аналогично названию столбцов в таблице раздела 3.1 (Таблица 3.1)

Срезы (соответствуют номерам столбцов  таблицы 3.7.1 Формы 1-ПК):

3. Всего (сумма срезов 4, 6, 8, 10, 12, 14, 16, 18, 20, 22)
4. Число полных лет по состоянию на 1 января 2019 года	(года следующего за отчетным)	менее 25
5. Из 4 - женщины
6. Число полных лет -//- 25–29	
7. Из 6 - женщины
8. Число полных лет -//- 30 – 34
9. Из 8 - женщины
10. Число полных лет -//- 35 - 39
11. Из 10 - женщины
12. Число полных лет -//- 40 - 44
13. Из 12 - женщины
14. Число полных лет -//- 45 - 49
15. Из 14 - женщины
16. Число полных лет -//- 50 - 54
17. Из 16 - женщины
18. Число полных лет -//- 55 - 59
19. Из 19 - женщины
20. Число полных лет -//- 60 - 64
21. Из 20 - женщины
22. Число полных лет -//- более 65
23. Из 22 - женщины


```{r data371_import, echo = FALSE}
#Чтение таблицы исходных данных подраздела запись данных в переменную
tab371 <- import_table("tab371.csv")

#Факторизация переменных "Федеральный округ", "Субъект федерации", "Срез"
tab371[c("FO_name", "Subj_Name", "Col_num")] <- lapply(tab371[c("FO_name", "Subj_Name", "Col_num")] , factor)

```



```{r tab371formation, echo = FALSE}
#Вывод таблицы 3.7.1 в отчет
get_dt(tab371, , 'tab371_data')
```

### Распределение персонала, работающего на условиях внешнего совместительства, по возрасту  и полу {#by-worker-demography}

В таблице исходных данных данного раздела значение заголовков столбцов (соотвествуют номерам строк в таблице 3.7.2 формы 1-ПК 2018):

1. Профессорско-преподавательский состав  - всего 
2. Педагогические работники структурных подразделений, реализующих дополнительные профессиональные программы, всего
3. Из 2 - преподаватели
4. Из 2 - мастера производственного обучения
5. Научные работники
6. Инженерно-технический персонал
7. Учебно-вспомогательный персонал

Срезы (соответствуют номерам столбцов  таблицы 3.7.2 Формы 1-ПК) и аналогичны срезам таблицы раздела 3.7.1 (таблица 3.7.1)


```{r data372_import, echo = FALSE}
#Чтение таблицы исходных данных подраздела запись данных в переменную
tab372 <- import_table("tab372.csv")

#Факторизация переменных "Федеральный округ", "Субъект федерации", "Срез"
tab372[c("FO_name", "Subj_Name", "Col_num")] <- lapply(tab372[c("FO_name", "Subj_Name", "Col_num")] , factor)

```



```{r tab372formation, echo = FALSE}
#Вывод таблицы 3.7.2 в отчет
get_dt(tab372, , 'tab372_data')
```